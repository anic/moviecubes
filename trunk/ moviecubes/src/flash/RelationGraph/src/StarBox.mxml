<?xml version="1.0" encoding="utf-8"?>
<mx:Module xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="190" height="220" initialize="init()">

	<mx:Script>
		<![CDATA[
			import mx.core.Application;
		
			private var started:Boolean = false;
			
			public var relationItem:RelationItem = null;
			
			public function reinit():void
			{
				started = false;
				init();
			}
			
			
			private function init():void
			{
				if (started)
					return;
					
				var i:int = 0;
				txtName.text = data.Name;
				
				if (data.Rank ==0)
					bxRank.visible = false;
				else
					txtRank.text = new String(data.Rank).substr(0,4);
				
				if(data.Alias==null || data.Alias.length == 0)
					bxAlias.visible = false;
				else
					{
						txtAlias.text = "";
						for(i= 0;i<data.Alias.length;++i)
						{
							if(i !=0)
								txtAlias.text += ",";
							txtAlias.text += data.Alias[i];										
						}
					}
					
				if (data.Movies==null || data.Movies.length == 0)
					txtMovies.text = "双击节点查看..."
				else
					{
						txtMovies.text = "";
						var pages:int = relationItem.getPagesCount(RelationGraph(Application.application).CountPerPage);
						var start:int = 0;
						var end:int = data.Movies.length-1;
						var countPerPage:int = RelationGraph(Application.application).CountPerPage;
						
						
						if (pages!=0)
						{
							var cur:int = relationItem.getCurrentPage(countPerPage);
							if (pages>1)
								txtMovies.text = cur+"/"+pages+"页，共"+relationItem.TotalNum+"\n";
							else
								txtMovies.text = "共"+relationItem.TotalNum+"\n";
							start = relationItem.start;
							end = start + countPerPage -1 < end? start + countPerPage -1 :end;
						}
						for(i = start;i<=end;++i)
						{
							if(i !=start )
								txtMovies.text += "\n";
							txtMovies.text += data.Movies[i].Movie.Name;										
						}
					}
					started = true;
			
			}
		]]>
	</mx:Script>
	<mx:VBox x="0" y="0" height="100%" width="100%" id="bxStar">
		<mx:HBox width="100%" id="bxName">
			<mx:Text text="姓名" width="50"/>
			<mx:Text id="txtName" width="100%"/>
		</mx:HBox>
		<mx:HBox width="100%" id="bxAlias"  includeInLayout="{bxAlias.visible}">
			<mx:Text text="别名" width="50"/>
			<mx:Text id="txtAlias" width="100%"/>
		</mx:HBox>
		<mx:HBox width="100%" id="bxMovies">
			<mx:Text text="电影" width="50" id="titleMovie"/>
			<mx:Text id="txtMovies" width="100%"/>
		</mx:HBox>
		<mx:HBox width="100%" id="bxRank"  includeInLayout="{bxRank.visible}">
			<mx:Text text="分数" width="50"/>
			<mx:Text id="txtRank" width="100%"/>
		</mx:HBox>

	</mx:VBox>
</mx:Module>
